{% comment %}
Reusable publication card component.
Parameters:
- id
- title
- authors
- venue
- year
- img (optional)
- img_alt (optional)
- video (optional: local .mp4 or YouTube embed URL)
- video_external (optional: a separate "Video" link)
- abstract (optional)
- website, paper, code, dataset, other_text+other_link (optional)
{% endcomment %}

<style>
.pub-card{display:flex;gap:14px;align-items:flex-start;margin:24px 0;padding:14px;border:1px solid #e8e8e8;border-radius:12px;background:#fff}
.pub-media{flex:0 0 260px}
.pub-media img,.pub-media iframe,.pub-media video{width:100%;height:auto;border-radius:10px;border:1px solid #eee}
.pub-body{flex:1;line-height:1.45}
.pub-title{font-size:1.10rem;font-weight:700;margin:0 0 4px}
.pub-meta{font-size:0.95rem;color:#555;margin-bottom:6px}
.pub-links{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.pub-links a,.pub-links button{padding:6px 10px;border-radius:8px;border:1px solid #ddd;background:#f7f7f7;font-size:.9rem;text-decoration:none;cursor:pointer}
.pub-abstract{display:none;margin-top:10px;padding:10px;border-left:3px solid #e0e0e0;background:#fafafa;border-radius:6px}
@media (max-width:800px){.pub-card{flex-direction:column}.pub-media{flex:unset}}
</style>

<div class="pub-card" id="pub-{{ include.id }}">
  <div class="pub-media">
    {% if include.video %}
      {% assign v = include.video | downcase %}
      {% if v contains 'youtube.com' or v contains 'youtu.be' or v contains 'embed' %}
        <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:10px;border:1px solid #eee">
          <iframe src="{{ include.video }}" title="video" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0" allowfullscreen></iframe>
        </div>
      {% else %}
        <video src="{{ include.video }}" controls playsinline></video>
      {% endif %}
    {% elsif include.img %}
      <img src="{{ include.img }}" alt="{{ include.img_alt | default: 'figure' }}">
    {% endif %}
  </div>

  <div class="pub-body">
    <div class="pub-title">{{ include.title }}</div>
    <div class="pub-meta">
      <span class="authors">
        {{ include.authors | replace: 'Nan Li', '<strong>Nan Li</strong>' }}
      </span><br/>
      <span class="venue">{{ include.venue }}{% if include.year %}, {{ include.year }}{% endif %}</span>
    </div>

    <div class="pub-links">
      {% if include.abstract %}
        <button type="button" onclick="(function(){var a=document.getElementById('abs-{{ include.id }}'); a.style.display=(a.style.display==='block')?'none':'block';})()">Abstract</button>
      {% endif %}
      {% if include.paper %}<a href="{{ include.paper }}" target="_blank">Paper</a>{% endif %}
      {% if include.website %}<a href="{{ include.website }}" target="_blank">Website</a>{% endif %}
      {% if include.code %}<a href="{{ include.code }}" target="_blank">Code</a>{% endif %}
      {% if include.video_external %}<a href="{{ include.video_external }}" target="_blank">Video</a>{% endif %}
      {% if include.dataset %}<a href="{{ include.dataset }}" target="_blank">Dataset</a>{% endif %}
      {% if include.other_text and include.other_link %}<a href="{{ include.other_link }}" target="_blank">{{ include.other_text }}</a>{% endif %}
    </div>

    {% if include.abstract %}
      <div class="pub-abstract" id="abs-{{ include.id }}">{{ include.abstract }}</div>
    {% endif %}
  </div>
</div>
